function [V] = tetra_volume(P)
P1 = P(:,:,1); P2 = P(:,:,2); P3 = P(:,:,3); P4 = P(:,:,4);

V=abs((P1(1,:)-P4(1,:)).*((P2(2,:)-P4(2,:)).*(P3(3,:)-P4(3,:))-(P2(3,:)-P4(3,:)).*(P3(2,:)-P4(2,:)))-...
      (P2(1,:)-P4(1,:)).*((P1(2,:)-P4(2,:)).*(P3(3,:)-P4(3,:))-(P1(3,:)-P4(3,:)).*(P3(2,:)-P4(2,:)))+...
      (P3(1,:)-P4(1,:)).*((P1(2,:)-P4(2,:)).*(P2(3,:)-P4(3,:))-(P1(3,:)-P4(3,:)).*(P2(2,:)-P4(2,:)))); % 四面体体积的六倍 6V

end

